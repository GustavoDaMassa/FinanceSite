<div class="page-container">
  <div class="page-header">
    <h1>{{ 'accounts.title' | translate }}</h1>
    <a mat-flat-button color="primary" routerLink="/accounts/new">
      <mat-icon>add</mat-icon>
      {{ 'accounts.new' | translate }}
    </a>
  </div>

  @if (loading()) {
    <app-loading-spinner />
  } @else if (accounts().length === 0) {
    <mat-card class="empty-state">
      <mat-card-content>
        <mat-icon>account_balance_wallet</mat-icon>
        <p>{{ 'accounts.empty' | translate }}</p>
        <a mat-flat-button color="primary" routerLink="/accounts/new">
          {{ 'accounts.new' | translate }}
        </a>
      </mat-card-content>
    </mat-card>
  } @else {
    <div class="accounts-grid">
      @for (account of accounts(); track account.id) {
        <mat-card
          class="account-card"
          [routerLink]="['/transactions']"
          [queryParams]="{ accountId: account.id }"
        >
          <mat-card-content>
            <div class="account-card__header">
              <div class="account-card__icon">
                <mat-icon>account_balance</mat-icon>
              </div>
              <div class="account-card__info">
                <h3>{{ account.accountName }}</h3>
                <span class="account-card__institution">{{ account.institution }}</span>
                @if (account.description) {
                  <span class="account-card__description">{{ account.description }}</span>
                }
              </div>
              <div class="account-card__actions">
                <a mat-icon-button [routerLink]="['/accounts', account.id, 'edit']" (click)="$event.stopPropagation()">
                  <mat-icon>edit</mat-icon>
                </a>
                <button mat-icon-button color="warn" (click)="confirmDelete(account); $event.stopPropagation()">
                  <mat-icon>delete</mat-icon>
                </button>
              </div>
            </div>

            <div class="account-card__balance-section">
              <span class="account-card__balance-label">{{ 'accounts.balance' | translate }}</span>
              <span class="account-card__balance" [class]="getBalanceClass(account.balance)">
                {{ account.balance | currency: 'BRL' : 'symbol' : '1.2-2' }}
              </span>
            </div>
          </mat-card-content>
        </mat-card>
      }
    </div>
  }
</div>
