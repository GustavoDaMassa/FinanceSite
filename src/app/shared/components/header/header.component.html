<!--
  Header Template — GitHub-style toolbar

  @if e o novo control flow do Angular 17+.
  Substitui *ngIf com sintaxe mais clara e melhor performance.

  RouterLink: diretiva que transforma <a> em navegacao SPA
  (sem recarregar a pagina — igual a um router do React).

  RouterLinkActive: adiciona a classe CSS 'active' automaticamente
  quando a rota corresponde ao link. Util para highlight visual.

  [matTooltip]: tooltip Material com texto traduzido.
  O pipe `translate` converte a chave i18n para o texto no idioma atual.
-->

<mat-toolbar class="header">
  <!-- Logo + Nome -->
  <a routerLink="/dashboard" class="header__logo">
    <img src="assets/logo.png" alt="FinanceSite" class="header__logo-img" />
    <span class="header__title">FinanceSite</span>
  </a>

  <!-- Nav links — so aparecem se autenticado -->
  @if (isAuthenticated()) {
    <nav class="header__nav">
      <a mat-button routerLink="/dashboard" routerLinkActive="active">
        {{ 'nav.dashboard' | translate }}
      </a>
      <a mat-button routerLink="/accounts" routerLinkActive="active">
        {{ 'nav.accounts' | translate }}
      </a>
      <a mat-button routerLink="/transactions" routerLinkActive="active">
        {{ 'nav.transactions' | translate }}
      </a>
      <a mat-button routerLink="/categories" routerLinkActive="active">
        {{ 'nav.categories' | translate }}
      </a>
      <a mat-button routerLink="/integrations" routerLinkActive="active">
        {{ 'nav.integrations' | translate }}
      </a>
    </nav>

    <!-- Hamburger menu — mobile only -->
    <button mat-icon-button [matMenuTriggerFor]="mobileNav" class="header__hamburger">
      <mat-icon>menu</mat-icon>
    </button>
    <mat-menu #mobileNav="matMenu">
      <a mat-menu-item routerLink="/dashboard">
        <mat-icon>dashboard</mat-icon>
        {{ 'nav.dashboard' | translate }}
      </a>
      <a mat-menu-item routerLink="/accounts">
        <mat-icon>account_balance_wallet</mat-icon>
        {{ 'nav.accounts' | translate }}
      </a>
      <a mat-menu-item routerLink="/transactions">
        <mat-icon>receipt_long</mat-icon>
        {{ 'nav.transactions' | translate }}
      </a>
      <a mat-menu-item routerLink="/categories">
        <mat-icon>label</mat-icon>
        {{ 'nav.categories' | translate }}
      </a>
      <a mat-menu-item routerLink="/integrations">
        <mat-icon>sync</mat-icon>
        {{ 'nav.integrations' | translate }}
      </a>
    </mat-menu>
  }

  <!-- Spacer — empurra os controles para a direita -->
  <span class="header__spacer"></span>

  <!-- Theme toggle -->
  <button
    mat-icon-button
    (click)="toggleTheme()"
    [matTooltip]="themeTooltip() | translate"
  >
    <mat-icon>{{ themeIcon() }}</mat-icon>
  </button>

  <!-- Language toggle -->
  <button
    mat-button
    class="header__lang-btn"
    (click)="toggleLang()"
    [matTooltip]="'language.switch' | translate"
  >
    {{ currentLangLabel() }}
  </button>

  <!-- User menu — so aparece se autenticado -->
  @if (isAuthenticated()) {
    <button mat-icon-button [matMenuTriggerFor]="userMenu" class="header__avatar">
      <span class="header__initials">{{ userInitials() }}</span>
    </button>

    <mat-menu #userMenu="matMenu">
      <div class="header__user-info" mat-menu-item disabled>
        {{ userName() }}
      </div>
      <button mat-menu-item (click)="logout()">
        <mat-icon>logout</mat-icon>
        {{ 'auth.logout' | translate }}
      </button>
    </mat-menu>
  }
</mat-toolbar>
